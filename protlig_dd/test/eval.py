import protlig_dd.utils.utils as utils
from protlig_dd.utils.eval_metrics import ProteinEvaluator, LigandEvaluator

# O05616, nonsense, nonsense, nosense w/ repeat units
seqs = ['MFPKNAWYVACTPDEIADKPLGRQICNEKIVFYRGPEGRVAAVEDFCPHRGAPLSLGFVRDGKLICGYHGLEMGCEGKTLAMPGQRVQGFPCIKSYAVEERYGFIWVWPGDRELADPALIHHLEWADNPEWAYGGGLYHIACDYRLMIDNLMDLTHETYVHASSIGQKEIDEAPVSTRVEGDTVITSRYMDNVMAPPFWRAALRGNGLADDVPVDRWQICRFAPPSHVLIEVGVAHAGKGGYDAPAEYKAGSIVVDFITPESDTSIWYFWGMARNFRPQGTELTETIRVGQGKIFAEDLDMLEQQQRNLLAYPERQLLKLNIDAGGVQSRRVIDRILAAEQEAADAALIARSAS','KRVYNTCAWEQIMLHRFSPKVNGYDTCLAWQHRIMFKPVTGNSYQLRHKWDFCPMNIAYVQTGHRKLSWFNPVDQMCYTAHLGRWKEFINQSTVDPYMHCLAWKQRGNVTIFHPEMYQDKLCRAWGNITFVMQHPRDYKWSLCVQHGAIRTFDMNKYWEPCLVQHGRFTAINWQKMCYDPRLNVHTQGWFKSICMRVNDWQFAHTPKGLSYEVQIRHWDMQFNKVCYTPGLRIWAHSNQDMKFTYVLCHGRQAIWSNTKDVHFPLCYRGMQWITEVNQKHSRFWMAPDYCLQGRHT','QIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWQIKEGDLFPMWLFPMWQIKEGDLFPMWQIKEGDLFPMW']

seqs_ref =['GSTFECLKRAWYVAAMSSEVEGEALFHRRILGTSVMIYRLADGTPVAMHDRCPHRFAPLHLGQREGDEIACRYHALRFDADGRCTHNPHGNGRIPDAARVRRFPLLERYGFLWIWMDDSDPDPALLPDFSPLEEGHPNAVAQTYMHMDVNYELIIDNVMDLSHIDHVHGEIITTRGQLSPVVPKVRERDTHISARWEWSQTPAMMIFAPFLPRPEDAARHYFDISWTAPANIQLSVGAVQDSDDFGDATSQYDLHTCTPEDAFKTHYFFATRRNHIVDDADYNRKKIEAMHAAFETEDGPIITAVQEEMGEAEFFSLDPVLMSNDVAPVKVRRRLRRMIVEEQAAAAAADAA','MFPKNAWYVACTPDEIADKPLGRQICNEKIVFYRGPEGRVAAVEDFCPHRGAPLSLGFVRDGKLICGYHGLEMGCEGKTLAMPGQRVQGFPCIKSYAVEERYGFIWVWPGDRELADPALIHHLEWADNPEWAYGGGLYHIACDYRLMIDNLMDLTHETYVHASSIGQKEIDEAPVSTRVEGDTVITSRYMDNVMAPPFWRAALRGNGLADDVPVDRWQICRFAPPSHVLIEVGVAHAGKGGYDAPAEYKAGSIVVDFITPESDTSIWYFWGMARNFRPQGTELTETIRVGQGKIFAEDLDMLEQQQRNLLAYPERQLLKLNIDAGGVQSRRVIDRILAAEQEAADAALIARSAS','KKK']

prot_evaluator = ProteinEvaluator()

'''
ppl = prot_evaluator.calculate_mlm_ppl(seqs)
print("Pseudo-perplexity scores:", ppl)
'''

cos_dist = prot_evaluator.calculate_emb_cos_distance(seqs, seqs_ref)
print("Cosine distances to reference sequences:", cos_dist)