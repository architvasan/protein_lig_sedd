import protlig_dd.utils.utils as utils
from protlig_dd.utils.eval_metrics import ProteinEvaluator, LigandEvaluator

# O05616, nonsense, nonsense, nosense w/ repeat units
seq1 = ['MGSTFECLKRAWYVAAMSSEVEGEALFHRRILGTSVMIYRLADGTPVAMHDRCPHRFAPLHLGQREGDEIACRYHALRFDADGRCTHNPHGNGRIPDAARVRRFPLLERYGFLWIWMDDSDPDPALLPDFSPLEEGHPNAVAQTYMHMDVNYELIIDNVMDLSHIDHVHGEIITTRGQLSPVVPKVRERDTHISARWEWSQTPAMMIFAPFLPRPEDAARHYFDISWTAPANIQLSVGAVQDSDDFGDATSQYDLHTCTPEDAFKTHYFFATRRNHIVDDADYNRKKIEAMHAAFETEDGPIITAVQEEMGEAEFFSLDPVLMSNDVAPVKVRRRLRRMIVEEQAAAAAADAA','MSTSQIQSLAYEVGAPTELPKFPLNQWYVAGFAWELKDKPVGRTLLGKPVVLFRTADGQPAALEDRCCHRALPLSHGTLEEQGVRCGYHGLLFNGAGQCLEVPGQAKVPTKAKVPAYHVRERDQILWIWFGSADHKEPTYEPPTYDIHSSGEYLYEGDVYHYDAPYQLIHDNLLDLSHLGYVHLRTIGGNAGIHMNAQMRVESDDKTVRVIRHMPDSVPPPTYTAAYPFKGNVDRWQEIEFCVTHLRIWTGAVDAGTDSLEDPSRGGFHMRGFHGVTPETENTSHYFWTIATNPKSNHEETKAKVVEQTAMTFEEDKVVIEVQYQNMLEFGPGPMVDIHVDVGANRARKIIEQLRQES','MFPKNAWYVACTPDEIADKPLGRQICNEKIVFYRGPEGRVAAVEDFCPHRGAPLSLGFVRDGKLICGYHGLEMGCEGKTLAMPGQRVQGFPCIKSYAVEERYGFIWVWPGDRELADPALIHHLEWADNPEWAYGGGLYHIACDYRLMIDNLMDLTHETYVHASSIGQKEIDEAPVSTRVEGDTVITSRYMDNVMAPPFWRAALRGNGLADDVPVDRWQICRFAPPSHVLIEVGVAHAGKGGYDAPAEYKAGSIVVDFITPESDTSIWYFWGMARNFRPQGTELTETIRVGQGKIFAEDLDMLEQQQRNLLAYPERQLLKLNIDAGGVQSRRVIDRILAAEQEAADAALIARSAS']

seq2 = ['MDTARTIHIMKGKVQGVFFRRAYTRDQARHLGITGWVRNKPDGTVELEAEGPKELLVELLAWCQQGPTARADVDDVDKVIWEPARGIKDFIIR','MAKQCEKIYVYGRVQGVYFRRYTYQRKAQHGITGYAKNLNDVEVLASGQDDVNIKSLMKHWLEHGPPAARVDHVEKTIEYRGRYDSFKIRY','MTDLNRATFLISGLVQGVCFRRASTRDEARRLGVHGWVRNLPDRRVWVLAHEEADVQRLTAWCRKGPPAAKVTEITEREAPGILEGQFLIRGSSDLDRFHVPAG']

seq3 = ['MGSTFECLKRAWYVAAMSSEVEGEALFHRRILGTSVMIYRLADGTPVAMHDRCPHRFAPLHLGQREGDEIACRYHALRFDADGRCTHNPHGNGRIPDAARVRRFPLLERYGFLWIWMDDSDPDPALLPDFSPLEEGHPNAVAQTYMHMDVNYELIIDNVMDLSHIDHVHGEIITTRGQLSPVVPKVRERDTHISARWEWSQTPAMMIFAPFLPRPEDAARHYFDISWTAPANIQLSVGAVQDSDDFGDATSQYDLHTCTPEDAFKTHYFFATRRNHIVDDADYNRKKIEAMHAAFETEDGPIITAVQEEMGEAEFFSLDPVLMSNDVAPVKVRRRLRRMIVEEQAAAAAADAA','MSTSQIQSLAYEVGAPTELPKFPLNQWYVAGFAWELKDKPVGRTLLGKPVVLFRTADGQPAALEDRCCHRALPLSHGTLEEQGVRCGYHGLLFNGAGQCLEVPGQAKVPTKAKVPAYHVRERDQILWIWFGSADHKEPTYEPPTYDIHSSGEYLYEGDVYHYDAPYQLIHDNLLDLSHLGYVHLRTIGGNAGIHMNAQMRVESDDKTVRVIRHMPDSVPPPTYTAAYPFKGNVDRWQEIEFCVTHLRIWTGAVDAGTDSLEDPSRGGFHMRGFHGVTPETENTSHYFWTIATNPKSNHEETKAKVVEQTAMTFEEDKVVIEVQYQNMLEFGPGPMVDIHVDVGANRARKIIEQLRQES','MFPKNAWYVACTPDEIADKPLGRQICNEKIVFYRGPEGRVAAVEDFCPHRGAPLSLGFVRDGKLICGYHGLEMGCEGKTLAMPGQRVQGFPCIKSYAVEERYGFIWVWPGDRELADPALIHHLEWADNPEWAYGGGLYHIACDYRLMIDNLMDLTHETYVHASSIGQKEIDEAPVSTRVEGDTVITSRYMDNVMAPPFWRAALRGNGLADDVPVDRWQICRFAPPSHVLIEVGVAHAGKGGYDAPAEYKAGSIVVDFITPESDTSIWYFWGMARNFRPQGTELTETIRVGQGKIFAEDLDMLEQQQRNLLAYPERQLLKLNIDAGGVQSRRVIDRILAAEQEAADAALIARSAS','MDTARTIHIMKGKVQGVFFRRAYTRDQARHLGITGWVRNKPDGTVELEAEGPKELLVELLAWCQQGPTARADVDDVDKVIWEPARGIKDFIIR','MAKQCEKIYVYGRVQGVYFRRYTYQRKAQHGITGYAKNLNDVEVLASGQDDVNIKSLMKHWLEHGPPAARVDHVEKTIEYRGRYDSFKIRY','MTDLNRATFLISGLVQGVCFRRASTRDEARRLGVHGWVRNLPDRRVWVLAHEEADVQRLTAWCRKGPPAAKVTEITEREAPGILEGQFLIRGSSDLDRFHVPAG',]

seqs_ref =['GSTFECLKRAWYVAAMSSEVEGEALFHRRILGTSVMIYRLADGTPVAMHDRCPHRFAPLHLGQREGDEIACRYHALRFDADGRCTHNPHGNGRIPDAARVRRFPLLERYGFLWIWMDDSDPDPALLPDFSPLEEGHPNAVAQTYMHMDVNYELIIDNVMDLSHIDHVHGEIITTRGQLSPVVPKVRERDTHISARWEWSQTPAMMIFAPFLPRPEDAARHYFDISWTAPANIQLSVGAVQDSDDFGDATSQYDLHTCTPEDAFKTHYFFATRRNHIVDDADYNRKKIEAMHAAFETEDGPIITAVQEEMGEAEFFSLDPVLMSNDVAPVKVRRRLRRMIVEEQAAAAAADAA','MFPKNAWYVACTPDEIADKPLGRQICNEKIVFYRGPEGRVAAVEDFCPHRGAPLSLGFVRDGKLICGYHGLEMGCEGKTLAMPGQRVQGFPCIKSYAVEERYGFIWVWPGDRELADPALIHHLEWADNPEWAYGGGLYHIACDYRLMIDNLMDLTHETYVHASSIGQKEIDEAPVSTRVEGDTVITSRYMDNVMAPPFWRAALRGNGLADDVPVDRWQICRFAPPSHVLIEVGVAHAGKGGYDAPAEYKAGSIVVDFITPESDTSIWYFWGMARNFRPQGTELTETIRVGQGKIFAEDLDMLEQQQRNLLAYPERQLLKLNIDAGGVQSRRVIDRILAAEQEAADAALIARSAS','KKK']

prot_evaluator = ProteinEvaluator()

for seq in [seq1, seq2, seq3]:
    ppl = prot_evaluator.calculate_mlm_ppl(seq)
    print("Pseudo-perplexity scores:", ppl)
'''

cos_dist = prot_evaluator.calculate_similarity(seqs, seqs_ref)
print("Lev ratio to reference sequences:", cos_dist)
'''